@if (transformedLocations(); as locations) {
  <div class="col-12 overflow-hidden">
    <h4 class="fw-bold mb-4">Location</h4>

    <div class="border rounded border-primary px-5 py-4">
      <mat-accordion class="mb-4" [multi]="true">
        @if (locations.length == 0) {
          <div class="d-flex justify-content-center align-items-center fs-24 mt-3">
            <p class="text-muted">No location found.</p>
          </div>
        }
        @for (location of locations; track location.id) {
          <mat-expansion-panel [expanded]="$index === 0" #panel>
            <mat-expansion-panel-header>
              <div class="">
                <div class="d-flex align-items-center fw-bold gap-4 text-uppercase" [style]="{ marginBottom: '20px' }">
                  {{ location.location_name }}
                  @if ($index === 0) {
                    <p class="d-flex align-items-center px-3 py-1 gap-2 background-on-primary primary text-uppercase fw-bold mb-0">
                      <mat-icon>domain</mat-icon>
                      Headquarters
                    </p>
                  }
                </div>

                <p class="text-muted small mb-0">{{ getLocationAddress(location) }}</p>
              </div>

              <!-- Show/Hide text -->
              <span
                class="ms-3 text-uppercase text-decoration-underline fw-bold {{ panel.expanded ? 'error' : 'primary' }}"
                style="font-size: 0.95em"
              >
                {{ panel.expanded ? 'Hide' : 'View' }}
              </span>
            </mat-expansion-panel-header>

            <div class="body-wrapper rounded-3 mb-4">
              <div class="row g-3 mb-4">
                <div class="col-12 col-sm-4 px-2">
                  <div class="fw-bold mb-1 text-uppercase">STREET ADDRESS</div>
                  <div>{{ location.street || '-' }}</div>
                </div>
                <div class="col-12 col-sm-4 px-2">
                  <div class="fw-bold mb-1 text-uppercase">ADDRESS LINE 2</div>
                  <div>{{ location.address_line || '-' }}</div>
                </div>
                <div class="col-12 col-sm-4 px-2">
                  <div class="fw-bold mb-1 text-uppercase">ZIP / POSTAL CODE</div>
                  <div>{{ location.postcode || '-' }}</div>
                </div>
              </div>
              <div class="row g-3 mb-4">
                <div class="col-12 col-sm-4 px-2">
                  <div class="fw-bold mb-1 text-uppercase">CITY</div>
                  <div>{{ location.city || '-' }}</div>
                </div>
                <div class="col-12 col-sm-4 px-2">
                  <div class="fw-bold mb-1 text-uppercase">COUNTY / STATE / REGION</div>
                  <div>{{ location.state_province || '-' }}</div>
                </div>
                <div class="col-12 col-sm-4 px-2">
                  <div class="fw-bold mb-1 text-uppercase">COUNTRY</div>
                  <div>{{ mapCountryCodeToName[location.country] || '-' }}</div>
                </div>
              </div>
              <div class="row g-3">
                <div class="col-12 col-sm-4 px-2">
                  <div class="fw-bold mb-1 text-uppercase">TELEPHONE</div>
                  <div>{{ location.phone_number || '-' }}</div>
                </div>
              </div>
            </div>

            <div class="body-wrapper rounded-3 mb-4">
              <p class="primary fw-bold text-uppercase" [style]="{ marginBottom: '24px' }">On-site facilities</p>
              <div class="row g-3 mb-4">
                <div class="col-12 col-sm-6 px-2">
                  <div class="fw-bold mb-1 text-uppercase">Is there a loading ramp on this site?*</div>
                  <div>{{ toYesNo(location.loading_ramp) }}</div>
                </div>
                <div class="col-12 col-sm-6 px-2">
                  <div class="fw-bold mb-1 text-uppercase">Have you got a weighbridge on this site?*</div>
                  <div>{{ toYesNo(location.weighbridge) }}</div>
                </div>
              </div>
              <div class="row g-3">
                <div class="col-12 col-sm-6 px-2">
                  <div class="fw-bold mb-1 text-uppercase">Can you load/unload material yourself on this site?*</div>
                  <div>{{ toYesNo(location.self_load_unload_capability) }}</div>
                </div>
                <div class="col-12 col-sm-6 px-2">
                  <div class="fw-bold mb-1 text-uppercase">Which container types can you manage on this site?*</div>
                  <div>{{ containerType(location) || '-' }}</div>
                </div>
              </div>
            </div>

            @if (materialAccepteds()[$index]; as materialAccepted) {
              @if (materialAccepted.length) {
                <div class="body-wrapper rounded-3">
                  <p class="primary fw-bold text-uppercase" [style]="{ marginBottom: '24px' }">MATERIAL ACCEPTED</p>
                  <div class="material-wrapper">
                    @for (materialType of materialAccepted; track materialType.code) {
                      <div class="">
                        <div class="text-uppercase fw-bold mb-2">{{ materialType.name }}</div>
                        <div class="d-flex flex-wrap gap-2">
                          {{ getMaterials(materialType) }}
                        </div>
                      </div>
                    }
                  </div>
                </div>
              }
            }
          </mat-expansion-panel>
        }
      </mat-accordion>
    </div>
  </div>
}
